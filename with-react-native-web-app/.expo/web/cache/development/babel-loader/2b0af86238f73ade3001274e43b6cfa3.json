{"ast":null,"code":"\"use strict\";\n\nvar _objectWithoutProperties = require(\"/Users/jun/Desktop/dev/react-practice/with-react-native-web-app/node_modules/next/dist/compiled/@babel/runtime/helpers/objectWithoutProperties\");\n\nvar _slicedToArray = require(\"/Users/jun/Desktop/dev/react-practice/with-react-native-web-app/node_modules/next/dist/compiled/@babel/runtime/helpers/slicedToArray\");\n\nvar _excluded = [\"style\"];\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PortalProvider = PortalProvider;\nexports.OverlayContainer = OverlayContainer;\nexports.OverlayProvider = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native-web/dist/cjs/index\");\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar PortalContext = /*#__PURE__*/_react[\"default\"].createContext(null);\n\nvar globalOverlayCounter = 0;\n\nfunction PortalProvider(props) {\n  var _react$default$useSta = _react[\"default\"].useState([]),\n      _react$default$useSta2 = _slicedToArray(_react$default$useSta, 2),\n      items = _react$default$useSta2[0],\n      setItems = _react$default$useSta2[1];\n\n  var setOverlayItem = function setOverlayItem(item) {\n    var overlayId = ++globalOverlayCounter;\n    setItems(function (prev) {\n      return prev.concat([{\n        id: overlayId,\n        node: item\n      }]);\n    });\n    return overlayId;\n  };\n\n  var updateOverlayItem = function updateOverlayItem(id, node) {\n    setItems(function (prev) {\n      return prev.map(function (item) {\n        if (item.id === id) {\n          return {\n            id: id,\n            node: node\n          };\n        }\n\n        return item;\n      });\n    });\n  };\n\n  var removeOverlayItem = function removeOverlayItem(id) {\n    setItems(function (prev) {\n      var newItems = prev.filter(function (item) {\n        return item.id !== id;\n      });\n      return newItems;\n    });\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(PortalContext.Provider, {\n    value: {\n      items: items,\n      setOverlayItem: setOverlayItem,\n      removeOverlayItem: removeOverlayItem,\n      updateOverlayItem: updateOverlayItem\n    }\n  }, props.children, items.map(function (item) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, {\n      key: item.id\n    }, item.node);\n  }));\n}\n\nfunction OverlayView(_ref) {\n  var style = _ref.style,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_reactNative.View, _extends({\n    pointerEvents: \"box-none\",\n    style: [_reactNative.StyleSheet.absoluteFill, style],\n    collapsable: false\n  }, props));\n}\n\nvar OverlayProvider = PortalProvider;\nexports.OverlayProvider = OverlayProvider;\n\nfunction OverlayContainer(props) {\n  var context = usePortalProvider();\n\n  var overlayId = _react[\"default\"].useRef(undefined);\n\n  var contents = /*#__PURE__*/_react[\"default\"].createElement(OverlayView, props);\n\n  (0, _react.useEffect)(function () {\n    // Mount\n    if (overlayId.current === undefined) {\n      overlayId.current = context === null || context === void 0 ? void 0 : context.setOverlayItem(contents);\n    } // Update\n    else {\n      if (overlayId.current) {\n        context === null || context === void 0 ? void 0 : context.updateOverlayItem(overlayId.current, contents);\n      }\n    }\n  }, // To re-render the child\n  [props]); // Unmount\n\n  (0, _react.useEffect)(function () {\n    return function () {\n      if (overlayId.current) {\n        context === null || context === void 0 ? void 0 : context.removeOverlayItem(overlayId.current);\n      }\n    };\n  }, []);\n  return null;\n}\n\nfunction usePortalProvider() {\n  var context = _react[\"default\"].useContext(PortalContext);\n\n  return context;\n}","map":{"version":3,"sources":["Portal.tsx"],"names":["PortalContext","React","globalOverlayCounter","setOverlayItem","item","overlayId","setItems","prev","id","node","updateOverlayItem","removeOverlayItem","newItems","items","props","StyleSheet","OverlayProvider","context","usePortalProvider","contents"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport type { ReactNode } from 'react';\nimport { StyleSheet, View, ViewProps } from 'react-native';\n\ntype OverlayItem = {\n  id: number;\n  node: ReactNode;\n};\n\ninterface PortalContext {\n  items: Array<OverlayItem>;\n  setOverlayItem: (node: ReactNode) => number;\n  removeOverlayItem: (id: number) => void;\n  updateOverlayItem: (id: number, node: ReactNode) => void;\n}\n\ninterface ModalProviderProps extends ViewProps {\n  children: ReactNode;\n  provider?: boolean;\n}\n\nconst PortalContext = React.createContext<PortalContext | null>(null);\n\nlet globalOverlayCounter = 0;\n\nexport function PortalProvider(props: { children: ReactNode }) {\n  const [items, setItems] = React.useState<Array<OverlayItem>>([]);\n\n  const setOverlayItem = (item: ReactNode) => {\n    const overlayId = ++globalOverlayCounter;\n    setItems((prev) => prev.concat([{ id: overlayId, node: item }]));\n    return overlayId;\n  };\n\n  const updateOverlayItem = (id: number, node: ReactNode) => {\n    setItems((prev) =>\n      prev.map((item) => {\n        if (item.id === id) {\n          return { id, node };\n        }\n        return item;\n      })\n    );\n  };\n\n  const removeOverlayItem = (id: number) => {\n    setItems((prev) => {\n      const newItems = prev.filter((item) => item.id !== id);\n      return newItems;\n    });\n  };\n\n  return (\n    <PortalContext.Provider\n      value={{ items, setOverlayItem, removeOverlayItem, updateOverlayItem }}\n    >\n      {props.children}\n\n      {/* Render Overlays */}\n      {items.map((item) => {\n        return <React.Fragment key={item.id}>{item.node}</React.Fragment>;\n      })}\n    </PortalContext.Provider>\n  );\n}\n\nfunction OverlayView({style, ...props}: ModalProviderProps) {\n  return (\n    <View\n      pointerEvents=\"box-none\"\n      style={[StyleSheet.absoluteFill, style]}\n      collapsable={false}\n      {...props}\n    />\n  );\n}\n\nexport const OverlayProvider = PortalProvider;\n\nexport function OverlayContainer(props: ModalProviderProps) {\n  const context = usePortalProvider();\n  const overlayId = React.useRef<number | undefined>(undefined);\n  let contents = <OverlayView {...props} />;\n\n  useEffect(\n    () => {\n      // Mount\n      if (overlayId.current === undefined) {\n        overlayId.current = context?.setOverlayItem(contents);\n      }\n      // Update\n      else {\n        if (overlayId.current) {\n          context?.updateOverlayItem(overlayId.current, contents);\n        }\n      }\n    },\n    // To re-render the child\n    [props]\n  );\n\n  // Unmount\n  useEffect(() => {\n    return () => {\n      if (overlayId.current) {\n        context?.removeOverlayItem(overlayId.current);\n      }\n    };\n  }, []);\n\n  return null;\n}\n\nfunction usePortalProvider() {\n  const context = React.useContext(PortalContext);\n  return context;\n}\n"]},"metadata":{},"sourceType":"script"}